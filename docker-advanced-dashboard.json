{
  "dashboard": {
    "id": null,
    "title": "Advanced Docker Monitoring",
    "timezone": "browser",
    "schemaVersion": 38,
    "version": 1,
    "refresh": "10s",
    "panels": [
      {
        "type": "graph",
        "title": "CPU Usage per Container",
        "datasource": "Prometheus",
        "targets": [
          {
            "expr": "sum(rate(container_cpu_usage_seconds_total{name!=\"\",container_label_com_docker_swarm_service_name!=\"\"}[1m])) by (container_label_com_docker_swarm_service_name)",
            "legendFormat": "{{container_label_com_docker_swarm_service_name}}",
            "refId": "A"
          }
        ],
        "alert": {
          "alertRuleTags": {},
          "conditions": [
            {
              "evaluator": {"params":[0.7],"type":"gt"},
              "operator": {"type":"and"},
              "query": {"params":["A"]},
              "reducer": {"type":"avg"},
              "type":"query"
            }
          ],
          "frequency":"30s",
          "handler":1,
          "name":"High CPU Usage"
        }
      },
      {
        "type": "graph",
        "title": "Memory Usage per Container",
        "datasource": "Prometheus",
        "targets": [
          {
            "expr": "container_memory_usage_bytes{name!=\"\",container_label_com_docker_swarm_service_name!=\"\"}",
            "legendFormat": "{{container_label_com_docker_swarm_service_name}}",
            "refId": "B"
          }
        ],
        "alert": {
          "alertRuleTags": {},
          "conditions": [
            {
              "evaluator": {"params":[0.8],"type":"gt"},
              "operator": {"type":"and"},
              "query": {"params":["B"]},
              "reducer": {"type":"avg"},
              "type":"query"
            }
          ],
          "frequency":"30s",
          "handler":1,
          "name":"High Memory Usage"
        }
      },
      {
        "type": "graph",
        "title": "Network I/O per Container",
        "datasource": "Prometheus",
        "targets": [
          {
            "expr": "rate(container_network_receive_bytes_total{name!=\"\"}[1m])",
            "legendFormat": "{{container_label_com_docker_swarm_service_name}} RX",
            "refId": "C"
          },
          {
            "expr": "rate(container_network_transmit_bytes_total{name!=\"\"}[1m])",
            "legendFormat": "{{container_label_com_docker_swarm_service_name}} TX",
            "refId": "D"
          }
        ]
      },
      {
        "type": "logs",
        "title": "Docker Container Logs",
        "datasource": "Loki",
        "targets": [
          {
            "expr": "{job=\"docker\"}",
            "refId": "E"
          }
        ],
        "gridPos": {"x":0,"y":12,"w":24,"h":10},
        "fieldConfig": {
          "defaults": {
            "custom": {},
            "mappings": [],
            "thresholds": {"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]}
          }
        }
      }
    ]
  }
}
